# binwalk

**Binwalk** ist ein Open-Source-Tool zur Analyse und Extraktion von binären Dateien, insbesondere Firmware-Images. Es wird häufig zur Reversing-Analyse und zum Auffinden eingebetteter Dateien und Code in Binärdaten verwendet.

### Installation

```bash
sudo apt install binwalk
# oder
pip install binwalk
```

### Grundfunktionen

#### 1. Signaturbasierte Analyse

```bash
binwalk <datei>
```

* Scannt Datei nach bekannten Signaturen (z.B. Filesysteme, komprimierte Daten).
* Ausgabe enthält Offset, Typ und Beschreibung.

#### 2. Extraktion eingebetteter Dateien

```bash
binwalk -e <datei>
```

* Extrahiert automatisch erkannte Dateien in `_<dateiname>.extracted`.

Optionen:

```bash
-E   # Nur bekannte Signaturen extrahieren
-M   # Rekursive Extraktion (nested filesystems)
--dd=<Typ>:<RegEx>  # Benutzerdefinierte Extraktion basierend auf MIME-Typ oder Regex
```

#### 3. Kompression erkennen und entpacken

```bash
binwalk -D '<type>:<regex>' <datei>
```

* Extrahiert spezifische Dateitypen, z.B.:

```bash
binwalk -D 'gzip:gz' firmware.bin
```

#### 4. Entropieanalyse

```bash
binwalk --entropy <datei>
```

* Zeigt Entropiediagramm, um verschlüsselte oder komprimierte Bereiche zu identifizieren.

#### 5. Visualisierung

```bash
binwalk --hexdump <datei>
binwalk --matplotlib <datei>
```

* Hexdump / grafische Darstellung der Datenstruktur.

#### 6. Signature-Datenbank aktualisieren

```bash
binwalk --update
```

* Aktualisiert interne Signaturdatenbank.

#### 7. Modul-Nutzung

Binwalk kann auch als Python-Modul verwendet werden:

```python
import binwalk
binwalk.scan('firmware.bin', signature=True, extract=True)
```

### Wichtige Optionen

| Option          | Beschreibung                                       |
| --------------- | -------------------------------------------------- |
| `-e`            | Extrahiert gefundene Dateien automatisch           |
| `-M`            | Rekursive Extraktion                               |
| `-r <file>`     | Benutzerdefinierte Signaturdatei                   |
| `--dd`          | Definiert Extraktionsregeln                        |
| `--entropy`     | Entropieanalyse                                    |
| `--hexdump`     | Hexdump-Ausgabe                                    |
| `--matplotlib`  | Grafische Darstellung                              |
| `--update`      | Signaturen aktualisieren                           |
| `--run-as=root` | Führt Extraktion mit Root-Rechten aus (gefährlich) |

### Beispiel-Workflows

**Firmware analysieren und alles extrahieren:**

```bash
binwalk -eM firmware.bin
```

**Nur Entropie anzeigen:**

```bash
binwalk --entropy firmware.bin
```

**Nur JPEG-Dateien extrahieren:**

```bash
binwalk -D 'jpeg' firmware.bin
```

### Speicherorte

* Extrahierte Dateien: `_<inputfile>.extracted/`
* Signaturen: `/usr/lib/binwalk/magic.bin` oder eigene mit `--magic`.

***

{% hint style="info" %}
&#x20;Binwalk erkennt nicht alle proprietären Formate automatisch. Analyse kann durch Entpacken mit `dd`, `foremost`, `binutils`, `unsquashfs` etc. ergänzt werden.
{% endhint %}
