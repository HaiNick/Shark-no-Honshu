# POST Content-Types

### Gängige Datei-MIMEs

| Dateityp            | Dateiendung     | Content-Type (MIME-Type)                                                    |
| ------------------- | --------------- | --------------------------------------------------------------------------- |
| HTML                | `.html`, `.htm` | `text/html`                                                                 |
| CSS                 | `.css`          | `text/css`                                                                  |
| JavaScript          | `.js`           | `application/javascript`                                                    |
| JSON                | `.json`         | `application/json`                                                          |
| XML                 | `.xml`          | `application/xml`                                                           |
| JPEG-Bild           | `.jpg`, `.jpeg` | `image/jpeg`                                                                |
| PNG-Bild            | `.png`          | `image/png`                                                                 |
| GIF-Bild            | `.gif`          | `image/gif`                                                                 |
| SVG-Bild            | `.svg`          | `image/svg+xml`                                                             |
| BMP-Bild            | `.bmp`          | `image/bmp`                                                                 |
| WebP-Bild           | `.webp`         | `image/webp`                                                                |
| PDF-Dokument        | `.pdf`          | `application/pdf`                                                           |
| Word-Dokument       | `.doc`          | `application/msword`                                                        |
| Word-Dokument (neu) | `.docx`         | `application/vnd.openxmlformats-officedocument.wordprocessingml.document`   |
| Excel-Datei         | `.xls`          | `application/vnd.ms-excel`                                                  |
| Excel-Datei (neu)   | `.xlsx`         | `application/vnd.openxmlformats-officedocument.spreadsheetml.sheet`         |
| PowerPoint          | `.ppt`          | `application/vnd.ms-powerpoint`                                             |
| PowerPoint (neu)    | `.pptx`         | `application/vnd.openxmlformats-officedocument.presentationml.presentation` |
| Textdatei           | `.txt`          | `text/plain`                                                                |
| CSV-Datei           | `.csv`          | `text/csv`                                                                  |
| ZIP-Archiv          | `.zip`          | `application/zip`                                                           |
| RAR-Archiv          | `.rar`          | `application/vnd.rar`                                                       |
| 7z-Archiv           | `.7z`           | `application/x-7z-compressed`                                               |
| TAR-Archiv          | `.tar`          | `application/x-tar`                                                         |
| GZIP-Archiv         | `.gz`           | `application/gzip`                                                          |
| MP3-Audio           | `.mp3`          | `audio/mpeg`                                                                |
| WAV-Audio           | `.wav`          | `audio/wav`                                                                 |
| MP4-Video           | `.mp4`          | `video/mp4`                                                                 |
| AVI-Video           | `.avi`          | `video/x-msvideo`                                                           |
| MPEG-Video          | `.mpeg`         | `video/mpeg`                                                                |
| OGG-Audio/Video     | `.ogg`          | `application/ogg`                                                           |

### Pentest Executables-MIMEs

| Dateityp                 | Dateiendung        | Content-Type (MIME-Type)                        |
| ------------------------ | ------------------ | ----------------------------------------------- |
| PHP-Skript               | `.php`             | `application/x-httpd-php`                       |
| PHP-Skript (alternative) | `.php`             | `text/php` oder `text/x-php`                    |
| Python-Skript            | `.py`              | `text/x-python`                                 |
| Perl-Skript              | `.pl`              | `application/x-perl`                            |
| Shell-Skript             | `.sh`              | `application/x-sh`                              |
| Bash-Skript              | `.bash`            | `application/x-sh`                              |
| Windows Batch-Skript     | `.bat`             | `application/x-msdownload`                      |
| Windows Executable       | `.exe`             | `application/vnd.microsoft.portable-executable` |
| DLL-Datei                | `.dll`             | `application/x-msdownload`                      |
| ASP-Skript               | `.asp`             | `application/x-aspx` (bzw. `text/asp`)          |
| ASP.NET-Skript           | `.aspx`            | `application/x-aspx`                            |
| Java-Datei               | `.jar`             | `application/java-archive`                      |
| Java-Quellcode           | `.java`            | `text/x-java-source`                            |
| Ruby-Skript              | `.rb`              | `application/x-ruby`                            |
| PowerShell-Skript        | `.ps1`             | `application/x-powershell`                      |
| ELF-Binary (Linux)       | keine feste Endung | `application/x-elf`                             |
| ISO-Abbild               | `.iso`             | `application/x-iso9660-image`                   |
| Android APK              | `.apk`             | `application/vnd.android.package-archive`       |
| Apple DMG                | `.dmg`             | `application/x-apple-diskimage`                 |

### Gefälschte MIMEs für Upload-Bypass

| Tatsächlicher Dateityp | Angegebene (gefälschte) Content-Type | Zweck / Trick                                                |
| ---------------------- | ------------------------------------ | ------------------------------------------------------------ |
| PHP-Skript (`.php`)    | `image/jpeg`                         | Tarnen als Bilddatei                                         |
| PHP-Skript (`.php`)    | `text/plain`                         | Tarnen als harmloser Text                                    |
| Shell-Skript (`.sh`)   | `application/octet-stream`           | Allgemeiner Binärdatentyp, unverdächtig                      |
| EXE-Datei (`.exe`)     | `application/octet-stream`           | Standard-Binärdatei, um als "beliebige Datei" durchzugehen   |
| PHP in `.jpg` verpackt | `image/jpeg`                         | Code im Bild verstecken (z. B. über PHP-Exif-Inject)         |
| ZIP-Archiv (`.zip`)    | `application/x-zip-compressed`       | Bypass durch komprimierte Malware oder Shells                |
| ASP-Skript (`.asp`)    | `text/html`                          | Tarnung als HTML-Datei                                       |
| Python-Skript (`.py`)  | `text/plain`                         | Tarnen als einfacher Text, um Upload-Filter zu umgehen       |
| JAR-Datei (`.jar`)     | `application/zip`                    | JARs sind ZIP-Container – kann für Verwirrung sorgen         |
| MP4-Video mit Payload  | `video/mp4`                          | Schadcode in Mediendateien einbetten (z. B. steganografisch) |

***

### **Strategien zur Content-Type-Fälschung bei Upload-Bypass**

* **image/jpeg**\
  → Perfekt, wenn Uploads auf Bilder beschränkt sind.\
  → Nutze z. B. PHP-Code in einer echten JPEG-Datei oder manipuliere die Magic Number.
* **text/plain**\
  → Gut bei Uploads von Textdateien (.txt).\
  → Ermöglicht oft das Hochladen von Skripten (PHP, Python), wenn nur Extension oder Content-Type geprüft wird.
* **application/octet-stream**\
  → Nützlich, wenn der Server unspezifische Binärdateien akzeptiert.\
  → Perfekt für EXE-Dateien, Shell-Skripte oder manipulierte Dateien.
* **application/zip**\
  → Funktioniert bei erlaubtem Upload von ZIP-Dateien.\
  → Shell oder Schadcode wird im Archiv versteckt (evtl. späteres Server-side Entpacken möglich).
* **video/mp4**\
  → Trick, um Payload in Mediendateien unterzubringen.\
  → Einsatz z. B. bei Uploads, die Videos erlauben (Vorsicht: Verarbeitung auf Serverseite oft strikter).
* **text/html**\
  → Bei Webseiten-Uploads (CMS, Blog-Uploads) kann ein ASP/PHP/JS-Skript getarnt als HTML hochgeladen werden.

***

**Allgemeine Hinweise:**

* Immer kombinieren mit passenden Extension-Tricks (.jpg.php, Doppel-Endungen wie `.php.jpg`).
* Wenn Magic Number geprüft wird: Datei-Inhalt entsprechend manipulieren oder echte Header verwenden.
* Serververhalten testen: Wird Extension, Content-Type oder Inhalt tatsächlich ausgewertet?
* BurpSuite, OWASP ZAP oder curl nutzen, um Content-Type frei zu setzen.
