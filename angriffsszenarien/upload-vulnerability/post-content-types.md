# post content-types — MIME types for upload bypass

## common file MIME types

| file type | extension | content-type (MIME-type) |
|-----------|-----------|--------------------------|
| HTML | `.html`, `.htm` | `text/html` |
| CSS | `.css` | `text/css` |
| javascript | `.js` | `application/javascript` |
| JSON | `.json` | `application/json` |
| XML | `.xml` | `application/xml` |
| JPEG image | `.jpg`, `.jpeg` | `image/jpeg` |
| PNG image | `.png` | `image/png` |
| GIF image | `.gif` | `image/gif` |
| SVG image | `.svg` | `image/svg+xml` |
| BMP image | `.bmp` | `image/bmp` |
| WebP image | `.webp` | `image/webp` |
| PDF document | `.pdf` | `application/pdf` |
| word document | `.doc` | `application/msword` |
| word document (new) | `.docx` | `application/vnd.openxmlformats-officedocument.wordprocessingml.document` |
| excel file | `.xls` | `application/vnd.ms-excel` |
| excel file (new) | `.xlsx` | `application/vnd.openxmlformats-officedocument.spreadsheetml.sheet` |
| powerpoint | `.ppt` | `application/vnd.ms-powerpoint` |
| powerpoint (new) | `.pptx` | `application/vnd.openxmlformats-officedocument.presentationml.presentation` |
| text file | `.txt` | `text/plain` |
| CSV file | `.csv` | `text/csv` |
| ZIP archive | `.zip` | `application/zip` |
| RAR archive | `.rar` | `application/vnd.rar` |
| 7z archive | `.7z` | `application/x-7z-compressed` |
| TAR archive | `.tar` | `application/x-tar` |
| GZIP archive | `.gz` | `application/gzip` |
| MP3 audio | `.mp3` | `audio/mpeg` |
| WAV audio | `.wav` | `audio/wav` |
| MP4 video | `.mp4` | `video/mp4` |
| AVI video | `.avi` | `video/x-msvideo` |
| MPEG video | `.mpeg` | `video/mpeg` |
| OGG audio/video | `.ogg` | `application/ogg` |

## pentest executable MIME types

| file type | extension | content-type (MIME-type) |
|-----------|-----------|--------------------------|
| PHP script | `.php` | `application/x-httpd-php` |
| PHP script (alternative) | `.php` | `text/php` or `text/x-php` |
| python script | `.py` | `text/x-python` |
| perl script | `.pl` | `application/x-perl` |
| shell script | `.sh` | `application/x-sh` |
| bash script | `.bash` | `application/x-sh` |
| windows batch script | `.bat` | `application/x-msdownload` |
| windows executable | `.exe` | `application/vnd.microsoft.portable-executable` |
| DLL file | `.dll` | `application/x-msdownload` |
| ASP script | `.asp` | `application/x-aspx` (or `text/asp`) |
| ASP.NET script | `.aspx` | `application/x-aspx` |
| java file | `.jar` | `application/java-archive` |
| java source code | `.java` | `text/x-java-source` |
| ruby script | `.rb` | `application/x-ruby` |
| powershell script | `.ps1` | `application/x-powershell` |
| ELF binary (linux) | no fixed extension | `application/x-elf` |
| ISO image | `.iso` | `application/x-iso9660-image` |
| android APK | `.apk` | `application/vnd.android.package-archive` |
| apple DMG | `.dmg` | `application/x-apple-diskimage` |

## fake MIME types for upload bypass

| actual file type | declared (fake) content-type | purpose / trick |
| PHP-Skript (`.php`)    | `image/jpeg`                         | Tarnen als Bilddatei                                         |
| PHP-Skript (`.php`)    | `text/plain`                         | Tarnen als harmloser Text                                    |
| Shell-Skript (`.sh`)   | `application/octet-stream`           | Allgemeiner Binärdatentyp, unverdächtig                      |
| EXE-Datei (`.exe`)     | `application/octet-stream`           | Standard-Binärdatei, um als "beliebige Datei" durchzugehen   |
| PHP in `.jpg` verpackt | `image/jpeg`                         | Code im Bild verstecken (z. B. über PHP-Exif-Inject)         |
| ZIP-Archiv (`.zip`)    | `application/x-zip-compressed`       | Bypass durch komprimierte Malware oder Shells                |
| ASP-Skript (`.asp`)    | `text/html`                          | Tarnung als HTML-Datei                                       |
| Python-Skript (`.py`)  | `text/plain`                         | Tarnen als einfacher Text, um Upload-Filter zu umgehen       |
| JAR-Datei (`.jar`)     | `application/zip`                    | JARs sind ZIP-Container – kann für Verwirrung sorgen         |
| MP4-Video mit Payload  | `video/mp4`                          | Schadcode in Mediendateien einbetten (z. B. steganografisch) |

***

### **Strategien zur Content-Type-Fälschung bei Upload-Bypass**

* **image/jpeg**\
  → Perfekt, wenn Uploads auf Bilder beschränkt sind.\
  → Nutze z. B. PHP-Code in einer echten JPEG-Datei oder manipuliere die Magic Number.
* **text/plain**\
  → Gut bei Uploads von Textdateien (.txt).\
  → Ermöglicht oft das Hochladen von Skripten (PHP, Python), wenn nur Extension oder Content-Type geprüft wird.
* **application/octet-stream**\
  → Nützlich, wenn der Server unspezifische Binärdateien akzeptiert.\
  → Perfekt für EXE-Dateien, Shell-Skripte oder manipulierte Dateien.
* **application/zip**\
  → Funktioniert bei erlaubtem Upload von ZIP-Dateien.\
  → Shell oder Schadcode wird im Archiv versteckt (evtl. späteres Server-side Entpacken möglich).
* **video/mp4**\
  → Trick, um Payload in Mediendateien unterzubringen.\
  → Einsatz z. B. bei Uploads, die Videos erlauben (Vorsicht: Verarbeitung auf Serverseite oft strikter).
* **text/html**\
  → Bei Webseiten-Uploads (CMS, Blog-Uploads) kann ein ASP/PHP/JS-Skript getarnt als HTML hochgeladen werden.

***

**Allgemeine Hinweise:**

* Immer kombinieren mit passenden Extension-Tricks (.jpg.php, Doppel-Endungen wie `.php.jpg`).
* Wenn Magic Number geprüft wird: Datei-Inhalt entsprechend manipulieren oder echte Header verwenden.
* Serververhalten testen: Wird Extension, Content-Type oder Inhalt tatsächlich ausgewertet?
* BurpSuite, OWASP ZAP oder curl nutzen, um Content-Type frei zu setzen.
