# php upload bypass — alternative extensions that execute

## alternative extensions with server mapping

| extension | notes | accepted by / typical systems |
|-----------|-------|-------------------------------|
| `.php` | standard | apache, nginx, IIS |
| `.php3` | old PHP 3 support | apache (older versions, some shared hosting) |
| `.php4` | old PHP 4 support | apache (legacy servers) |
| `.php5` | PHP 5 support | apache, nginx (older versions, poorly maintained) |
| `.php7` | PHP 7 support | rare, misconfigured new servers only |
| `.phtml` | formerly common for PHP files | apache (if `AddHandler` or `AddType` misconfigured) |
| `.pht` | abbreviation sometimes mapped to PHP | apache (configuration errors only) |
| `.phps` | normally shows source code, **can execute if misconfigured** | apache, some shared hosting |
| `.phar` | PHP archive format, contains PHP bytecode | apache (if not explicitly blocked) |
| `.inc` | include files - executable if directly accessible | apache, nginx (unsafe include handling) |
| `.module` | module extension, e.g. drupal CMS | apache, nginx (drupal or other CMS environments) |
| `.tpl` | template files, sometimes with embedded PHP | webservers with weak template validation |
| `.html` / `.htm` | if misconfigured, can be interpreted as PHP | apache (if `.html` mapped to PHP via `AddHandler`) |
| `.shtml` | server side includes (SSI), partially with PHP | apache with SSI enabled |
| `.phtm` | typo extension but sometimes mapped | apache (wildcard handlers set) |
| `.xphp` | rare manual mapping errors | custom setups, poorly configured servers |

***

## Zusatzinfos:

* **Null-Byte-Injektion (%00-Trick):**
  * Alt, funktioniert oft bei PHP < 5.3.4.
  * Beispiel: `shell.php%00.jpg`
* **Double Content-Type Angriffe:**
  * Beispiel: Zwei Content-Type-Header gleichzeitig senden, z.B. `image/jpeg` + `application/x-httpd-php`.
  * Funktioniert nur bei extrem unsicheren Servern, meist veraltet.
* **Server-Handler-Konfiguration:**
  * Apache: sehr flexibel – viele Extensions können falsch gemappt werden (via `.htaccess` oder `AddType`, `AddHandler`).
  * Nginx: weniger fehleranfällig, da Extension-Mapping expliziter ist, aber gefährlich bei schlechter FastCGI-Config.
  * IIS: stark abhängig von MIME-Type- und Handler-Mapping, kann bei alten Versionen (`IIS 6/7`) durch Doppel-Endungen ausgetrickst werden.

***

**Info:**\
Mit `OPTIONS` oder gezielten Fehlanfragen kann oft herausgefunden werden, welche Extensions der Server annimmt
