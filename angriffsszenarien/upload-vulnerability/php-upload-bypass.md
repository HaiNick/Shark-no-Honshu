# bypass php extension filters. alternative extensions that still execute.

| extension | server mapping | works on |
|-----------|---------------|----------|
| `.php` | standard | apache, nginx, iis |
| `.php3` | old php 3 | apache (legacy, shared hosting) |
| `.php4` | old php 4 | apache (legacy servers) |
| `.php5` | php 5 | apache, nginx (older/misconfigured) |
| `.php7` | php 7 | rare, misconfigured setups |
| `.phtml` | php html | apache (`AddHandler` misconfigured) |
| `.pht` | php abbreviation | apache (config errors) |
| `.phps` | php source | apache (normally shows source, executes if misconfigured) |
| `.phar` | php archive | apache (if not blocked) |
| `.inc` | include files | apache, nginx (unsafe includes) |
| `.module` | cms modules | drupal/cms environments |
| `.tpl` | templates | weak template validation |
| `.html/.htm` | html | apache (if `.html` mapped to php handler) |
| `.shtml` | server includes | apache with ssi enabled |
| `.phtm` | typo extension | apache (wildcard handlers) |
| `.xphp` | custom mapping | misconfigured servers |

## other bypass methods

**null byte injection:**
- `shell.php%00.jpg` (php < 5.3.4)
- server stops reading at null byte

**double content-type:**
- send multiple content-type headers
- `Content-Type: image/jpeg` + `Content-Type: application/x-httpd-php`
- works on broken parsers

**case variation:**
- `.PhP`, `.pHp`, `.PHP`
- some filters case-sensitive

**trailing characters:**
- `shell.php.` (trailing dot)
- `shell.php   ` (trailing spaces)
- `shell.php...` (multiple dots)

## server enumeration

test accepted extensions:
```bash
# check what server accepts
curl -X OPTIONS http://target/upload/
```

probe with errors:
```bash
# deliberate bad requests reveal handler info
curl -X POST -F "file=@test.unknown" http://target/upload.php
```

## [!] operational notes

- apache: very flexible - many extensions misconfigured via `.htaccess`
- nginx: less error-prone but dangerous with bad fastcgi config  
- iis: depends on mime/handler mapping, double extensions work on iis 6/7
- always test multiple extensions - systems often have multiple handlers

# TODO: test with mod_security enabled
