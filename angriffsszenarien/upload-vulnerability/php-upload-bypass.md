# PHP Upload-Bypass

## Alternative-Extensions mit Server-Zuordnung

| Extension        | Bemerkung                                                                                      | Wird akzeptiert von / Typische Systeme                                      |
| ---------------- | ---------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------- |
| `.php`           | Standard                                                                                       | Apache, Nginx, IIS                                                          |
| `.php3`          | Alte PHP 3-Unterstützung                                                                       | Apache (ältere Versionen, manche Shared-Hostings)                           |
| `.php4`          | Alte PHP 4-Unterstützung                                                                       | Apache (Legacy-Server)                                                      |
| `.php5`          | PHP 5-Unterstützung                                                                            | Apache, Nginx (ältere Versionen, schlecht gewartete Server)                 |
| `.php7`          | PHP 7-Unterstützung                                                                            | Selten, nur bei falsch konfigurierten neuen Servern                         |
| `.phtml`         | Früher üblich für PHP-Dateien                                                                  | Apache (wenn `AddHandler` oder `AddType` falsch gesetzt)                    |
| `.pht`           | Abkürzung; manchmal gemappt auf PHP                                                            | Apache (nur bei fehlerhafter Konfiguration)                                 |
| `.phps`          | Normalerweise zeigt Quellcode (Highlight), **kann aber bei falscher Config ausgeführt werden** | Apache, manche Shared-Hostings                                              |
| `.phar`          | PHP-Archive-Format, enthält PHP-Bytecode                                                       | Apache (wenn nicht explizit blockiert)                                      |
| `.inc`           | Include-Dateien; wenn direkt aufrufbar, kann ausführbar sein                                   | Apache, Nginx (unsichere Include-Handling)                                  |
| `.module`        | Modul-Extension, z.B. bei Drupal CMS                                                           | Apache, Nginx (wenn Drupal oder andere CMS laufen)                          |
| `.tpl`           | Template-Dateien, manchmal PHP eingebettet                                                     | Webserver mit schwacher Template-Validierung (z.B. ältere Smarty-Versionen) |
| `.html` / `.htm` | Falls falsch konfiguriert, kann als PHP interpretiert werden                                   | Apache (wenn `.html` zu PHP verarbeitet wird, z.B. via `AddHandler`)        |
| `.shtml`         | Server Side Includes (SSI), teilweise mit PHP                                                  | Apache mit SSI aktiviert                                                    |
| `.phtm`          | Tippfehler-Endung, aber manchmal gemappt                                                       | Apache (wenn wildcard-Handler gesetzt)                                      |
| `.xphp`          | Seltene manuelle Mapping-Fehler                                                                | Custom-Setups, schlecht konfigurierte Server                                |

***

## Zusatzinfos:

* **Null-Byte-Injektion (%00-Trick):**
  * Alt, funktioniert oft bei PHP < 5.3.4.
  * Beispiel: `shell.php%00.jpg`
* **Double Content-Type Angriffe:**
  * Beispiel: Zwei Content-Type-Header gleichzeitig senden, z.B. `image/jpeg` + `application/x-httpd-php`.
  * Funktioniert nur bei extrem unsicheren Servern, meist veraltet.
* **Server-Handler-Konfiguration:**
  * Apache: sehr flexibel – viele Extensions können falsch gemappt werden (via `.htaccess` oder `AddType`, `AddHandler`).
  * Nginx: weniger fehleranfällig, da Extension-Mapping expliziter ist, aber gefährlich bei schlechter FastCGI-Config.
  * IIS: stark abhängig von MIME-Type- und Handler-Mapping, kann bei alten Versionen (`IIS 6/7`) durch Doppel-Endungen ausgetrickst werden.

***

**Info:**\
Mit `OPTIONS` oder gezielten Fehlanfragen kann oft herausgefunden werden, welche Extensions der Server annimmt
